From e4ffbfd422b81c4679f182c9b8e3e198c956070e Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Bart=C5=82omiej=20Burdukiewicz?=
 <bartlomiej.burdukiewicz@gmail.com>
Date: Thu, 22 Oct 2020 17:55:49 +0200
Subject: [PATCH] enable dri without dri drivers (mesa 20.2.1).
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Signed-off-by: Bart≈Çomiej Burdukiewicz <bartlomiej.burdukiewicz@gmail.com>
---
 meson.build       | 2 +-
 meson_options.txt | 6 ++++++
 2 files changed, 7 insertions(+), 1 deletion(-)

diff --git a/meson.build b/meson.build
index 8c8c224..9dd2617 100644
--- a/meson.build
+++ b/meson.build
@@ -182,7 +182,7 @@ with_dri_r200 = dri_drivers.contains('r200')
 with_dri_nouveau = dri_drivers.contains('nouveau')
 with_dri_swrast = dri_drivers.contains('swrast')
 
-with_dri = dri_drivers.length() != 0
+with_dri = get_option('dri') or (dri_drivers.length() != 0 and dri_drivers != [''])
 
 gallium_drivers = get_option('gallium-drivers')
 if gallium_drivers.contains('auto')
diff --git a/meson_options.txt b/meson_options.txt
index 72006eb..147cccb 100644
--- a/meson_options.txt
+++ b/meson_options.txt
@@ -42,6 +42,12 @@ option(
   choices : ['auto', 'true', 'false', 'disabled', 'enabled'],
   description : 'enable support for dri3'
 )
+option(
+  'dri',
+  type : 'boolean',
+  value : false,
+  description : 'enable support for dri'
+)
 option(
   'dri-drivers',
   type : 'array',
